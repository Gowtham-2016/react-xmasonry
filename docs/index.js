!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React")):"function"==typeof define&&define.amd?define(["React"],t):"object"==typeof exports?exports["react-xmasonry"]=t(require("React")):e["react-xmasonry"]=t(e.React)}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),c=o(s),d=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"render",value:function(){var e={"data-key":this.props["data-key"],"data-width":this.props["data-width"]};return this.props["data-xkey"]&&(e["data-xkey"]=this.props["data-xkey"]),c.default.createElement("div",u({},e,{style:u({},this.props.style,t.defaultStyle),className:this.props.measured?"xblock":""}),this.props.children)}}]),t}(c.default.Component);d.defaultProps={width:1,measured:!1},d.defaultStyle={position:"absolute"},t.default=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(0),d=o(c),f=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={blocks:{},containerHeight:0,columns:1,containerWidth:0},n.container=null,n.mounted=!1,n.resizeListener=null,n.debouncedResizeTimeout=0,n.debounceRate=50,n.fixedHeight=0,n.containerWidth=n.state.containerWidth,n.columns=n.state.columns,n.props.responsive&&window.addEventListener("resize",n.resizeListener=n.onResize.bind(n)),n.onResize(),n}return a(t,e),s(t,[{key:"getColumns",value:function(e){return Math.max(1,Math.round(e/this.props.targetBlockWidth))}},{key:"updateContainerWidth",value:function(){var e=this.container.getBoundingClientRect().width;return e===this.containerWidth||(this.setState({columns:this.columns=this.getColumns(e),containerWidth:this.containerWidth=e,blocks:{}}),!1)}},{key:"componentDidMount",value:function(){this.mounted=!0,this.updateContainerWidth()&&this.measureChildren()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.resizeListener&&window.removeEventListener("resize",this.resizeListener)}},{key:"componentWillReceiveProps",value:function(e){e.children.length<this.props.children.length&&this.setState({blocks:{}})}},{key:"componentDidUpdate",value:function(){this.updateContainerWidth()&&this.measureChildren()}},{key:"measureChildren",value:function(){for(var e={},t=0;t<this.container.children.length;t++){var n=this.container.children[t];if(void 0!==n.dataset.xkey){var o=n.getBoundingClientRect(),r=o.height;e[n.dataset.xkey]={height:Math.ceil(r)}}}Object.keys(e).length>0&&this.recalculatePositions(e)}},{key:"recalculatePositions",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=l({},this.state.blocks,e),o=Array.from({length:this.columns},function(){return 0}),r=0;r<this.container.children.length;r++){var i=this.container.children[r];if(n.hasOwnProperty(i.dataset.key)){var a=+i.dataset.width||1,u=t.getBestFitColumn(o,a),s=u.col,c=u.height,d=c+n[i.dataset.key].height;n[i.dataset.key].left=this.containerWidth*s/this.columns,n[i.dataset.key].top=c;for(var f=0;f<a;++f)o[s+f]=d}}if(this.props.center&&0===o[o.length-1]){for(var h=1;0===o[o.length-1-h];++h);var y=this.containerWidth*h/this.columns/2;for(var p in n)n[p].left+=y}this.setState({blocks:n,containerHeight:Math.max.apply(null,o)})}},{key:"onResize",value:function(){var e=this;if(this.mounted){if(this.debouncedResizeTimeout)return clearTimeout(this.debouncedResizeTimeout),void(this.debouncedResizeTimeout=setTimeout(function(){e.debouncedResizeTimeout=null,e.updateContainerWidth(e)},this.debounceRate));this.updateContainerWidth(),this.debouncedResizeTimeout=setTimeout(function(){return e.debouncedResizeTimeout=0},this.debounceRate)}}},{key:"render",value:function(){var e=this,n=d.default.Children.toArray(this.props.children).reduce(function(t,n){var o=e.state.blocks[n.key],r=Math.min(n.props.width,e.columns);return t[o?0:1].push(o?d.default.cloneElement(n,{"data-key":n.key,"data-width":r,style:{width:Math.floor(r*e.containerWidth/e.columns),height:o.height,left:Math.floor(o.left),top:o.top},measured:!0,width:r}):d.default.cloneElement(n,{"data-key":n.key,"data-width":r,"data-xkey":n.key,style:{width:Math.floor(r*e.containerWidth/e.columns),visibility:"hidden"},width:r})),t},[[],[]]),o=u(n,2),r=o[0],i=o[1],a=i.length?this.fixedHeight:this.fixedHeight=this.state.containerHeight;return d.default.createElement("div",{className:"xmasonry",style:l({},t.containerStyle,{height:a}),ref:function(t){return e.container=t}},r,i)}}],[{key:"getBestFitColumn",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,o=1/0,r=0;r<e.length-t+1;++r){var i=Math.max.apply(null,e.slice(r,r+t));i<o&&(o=i,n=r)}return{col:n,height:o}}}]),t}(d.default.Component);f.propTypes={center:d.default.PropTypes.bool,responsive:d.default.PropTypes.bool,targetBlockWidth:d.default.PropTypes.number},f.defaultProps={center:!0,responsive:!0,targetBlockWidth:300},f.containerStyle={position:"relative"},t.default=f},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.XBlock=t.XMasonry=void 0;var r=n(2),i=o(r),a=n(1),u=o(a);t.XMasonry=i.default,t.XBlock=u.default,"undefined"!=typeof window&&(window.XMasonry=i.default,window.XBlock=u.default)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(0),s=o(l),c=n(3),d=function(e){function t(){var e,n,o,a;r(this,t);for(var u=arguments.length,l=Array(u),s=0;s<u;s++)l[s]=arguments[s];return n=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.state={data:[{id:1,header:"Hello!",body:"This is the body. This is successfully rendered card."}]},o.key=o.state.data.length,a=n,i(o,a)}return a(t,e),u(t,[{key:"addCard",value:function(){this.setState({data:this.state.data.concat({id:++this.key,header:"This is a dummy card",body:["This is a dummy body. Dummy body. Dummy body. Dummy body. Dummy body",". Dummy body. Dummy body. Dummy body. Dummy body. Dummy body",". Dummy body. Dummy body. Dummy body. Dummy body. Dummy body",". Dummy body. Dummy body. Dummy body. Dummy body. Dummy body.",". Dummy body. Dummy body. Dummy body. Dummy body. Dummy body.",". Dummy body. Dummy body. Dummy body. Dummy body. Dummy body."].slice(0,Math.floor(6*Math.random())+1),width:Math.floor(1+1.5*Math.random())})}),setTimeout(function(){window.scrollTo(0,document.body.scrollHeight)},50)}},{key:"deleteCard",value:function(){if(!(this.state.data.length<1)){var e=this.state.data.slice();e.splice(Math.floor(Math.random()*e.length),1),this.setState({data:e})}}},{key:"render",value:function(){return s.default.createElement("div",null,s.default.createElement(c.XMasonry,null,this.state.data.map(function(e,t){return s.default.createElement(c.XBlock,{key:e.id,width:e.width||1},s.default.createElement("div",{className:"card"},s.default.createElement("h1",null,"[",e.id,"] ",e.header),s.default.createElement("p",null,e.body)))})),s.default.createElement("div",{style:{textAlign:"center",paddingTop:20}},s.default.createElement("button",{onClick:this.addCard.bind(this)},"Add Random Card"),s.default.createElement("button",{onClick:this.deleteCard.bind(this)},"Delete random card")))}}]),t}(s.default.Component);window.init=function(){ReactDOM.render(s.default.createElement(d,null),document.getElementById("root"))}}])});